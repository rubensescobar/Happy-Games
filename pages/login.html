<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BuscaGames - Login</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.7.2/css/all.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />

    <!-- Styles -->
    <link rel="stylesheet" href="../assets/CSS/global.css">
  <link rel="stylesheet" href="../assets/CSS/theme.css">
    <link rel="stylesheet" href="../assets/CSS/login&cadastro.css">
    <link rel="stylesheet" href="../assets/CSS/immersive.css">
    <link rel="stylesheet" href="../assets/CSS/immersive-cards.css">
    <link rel="stylesheet" href="../assets/CSS/icon-styles.css">
    <link rel="stylesheet" href="../assets/CSS/userDropdown.css">

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom Scripts -->
    <script src="../assets/js/auth.js"></script>

    <!-- Additional Styles -->
    <style>
      /* Form validation styles */
      .is-invalid {
        border-color: #dc3545 !important;
        padding-right: calc(1.5em + 0.75rem);
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23dc3545'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right calc(0.375em + 0.1875rem) center;
        background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
      }
      
      .is-valid {
        border-color: #198754 !important;
        padding-right: calc(1.5em + 0.75rem);
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%23198754' d='M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right calc(0.375em + 0.1875rem) center;
        background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
      }
      
      .invalid-feedback {
        display: none;
        width: 100%;
        margin-top: 0.25rem;
        font-size: 0.875em;
        color: #dc3545;
      }
      
      .is-invalid ~ .invalid-feedback {
        display: block;
      }
      
      .form-floating .is-invalid ~ label {
        color: #dc3545;
      }
      
      .form-floating .is-valid ~ label {
        color: #198754;
      }
      
      /* Password validation styles */
      .password-requirements ul {
        list-style-type: none;
        padding-left: 0.5rem;
      }
      
      .password-requirements li {
        color: var(--color-purpledark);
        margin-bottom: 0.25rem;
        position: relative;
        padding-left: 1.5rem;
      }
      
      .password-requirements li::before {
        content: "×";
        font-weight: bold;
        font-size: 1.2rem;
        position: absolute;
        left: 0;
        top: -0.25rem;
      }
      
      .password-requirements li.valid {
        color: var(--color-green);
      }
      
      .password-requirements li.valid::before {
        content: "✓";
      }
      
      /* Dark mode specific styles for password requirements */
      :root[data-theme="dark"] .password-requirements li,
      :root[data-theme="dark"] .password-requirements p {
        color: var(--color-white-cottom);
      }

      /* Light mode specific styles */
      :root:not([data-theme="dark"]) .bloco.card {
        background-color: var(--border-color);
      }

      :root:not([data-theme="dark"]) .form-label,
      :root:not([data-theme="dark"]) .form-check-label,
      :root:not([data-theme="dark"]) .txtOpcoes {
        color: var(--color-purpledark);
      }
      
      :root:not([data-theme="dark"]) .nav-link {
        color: var(--color-purpledark);
      }

      :root:not([data-theme="dark"]) input.form-control {
        background-color: var(--color-white-cottom);
        color: var(--color-purpledark);
      }
      
      /* New styles for achievement card in light mode */
      :root:not([data-theme="dark"]) .achievement-card {
        background-color: var(--color-white-cottom);
      }
      
      :root:not([data-theme="dark"]) .achievement-icon,
      :root:not([data-theme="dark"]) .achievement-title,
      :root:not([data-theme="dark"]) .achievement-card p {
        color: var(--color-purpledark);
      }
    </style>
  </head>

  <body>
    <!-- Immersive Navbar -->
    <nav class="navbar navbar-expand-lg navbar-immersive fixed-top">
      <div class="container">
        <a class="navbar-brand" href="../index.html">
          <div class="logo-container">
            <img src="../assets/images/logo.png" alt="BuscaGames" class="logo">
          </div>
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
          <i class="fas fa-bars text-light"></i>
        </button>
        
        <div class="collapse navbar-collapse" id="navbarContent">
          <ul class="navbar-nav mx-auto">
            <li class="nav-item">
              <a class="nav-link" href="../index.html">
                <i class="fas fa-home me-1"></i> Home
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="games.html">
                <i class="fas fa-gamepad me-1"></i> Games
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="quests.html">
                <i class="fas fa-tasks me-1"></i> Quests
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="info.html">
                <i class="fas fa-info-circle me-1"></i> Informações
              </a>
            </li>
          </ul>
          
          <div class="navbar-nav ms-auto">
          <!-- Theme Toggle -->
          <div class="theme-toggle-container me-3">
            <button id="themeToggle" class="theme-toggle" aria-label="Toggle dark/light mode">
              <i class="fas fa-moon"></i>
            </button>
          </div>
          
          <!-- User Level -->
            <div class="user-level d-none d-lg-flex align-items-center me-3" id="userLevelContainer">
              <div class="level-badge">
                <span id="userLevel">1</span>
              </div>
              <div class="level-progress ms-2">
                <div class="xp-bar">
                  <div class="xp-fill" id="userXpBar" style="width: 25%"></div>
                </div>
                <div class="xp-text" id="userXpText">75 XP para o próximo nível</div>
              </div>
            </div>
          
            <!-- Cart -->
            <a href="cart.html" class="nav-link position-relative me-3">
              <i class="fas fa-shopping-cart cart-icon"></i>
              <span class="cart-count">0</span>
            </a>
            
            <!-- Login Button (Hidden when logged in) -->
            <div id="loginNavItem">
              <a class="nav-link" href="login.html">
                <i class="fas fa-sign-in-alt me-1"></i>
                <span>Login</span>
              </a>
            </div>
            
            <!-- User Dropdown (Hidden by default, shown when logged in) -->
            <div class="user-dropdown d-none" id="userDropdownContainer">
              <div class="user-dropdown-header" id="userDropdownToggle">
                <div class="user-avatar">
                  <i class="fas fa-user"></i>
                </div>
                <span class="user-name" id="userDropdownName">Usuário</span>
                <i class="fas fa-chevron-down dropdown-arrow"></i>
              </div>
              <div class="user-dropdown-menu" id="userDropdownMenu">
                <a href="profile.html" class="dropdown-item" id="userDropdownProfileLink">
                  <i class="fas fa-user"></i> Perfil
                </a>
                <div class="dropdown-divider"></div>
                <a href="#" class="dropdown-item" id="userDropdownLogoutLink">
                  <i class="fas fa-sign-out-alt"></i> Logout
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </nav>

    <!-- Main Section with appropriate spacing for fixed navbar -->
    <section class="corpo py-5 mt-5">
      <div class="container">
        <div class="row gx-lg-5 align-items-center">
          <div class="col-lg-6 mb-5 mb-lg-0">
            <h1 class="my-5 display-3 fw-bold ls-tight">
              As melhores ofertas <br />
              <span class="txtSpan">para seus jogos</span>
            </h1>
            <p class="lead text-light mb-4">
              Entre na sua conta para acessar ofertas especiais e acompanhar seus pedidos ou crie uma conta para começar a acumular pontos.
            </p>
            <div class="achievement-card animate-on-load">
              <div class="achievement-icon">
                <i class="fas fa-user-shield"></i>
              </div>
              <h3 class="achievement-title">Bônus de Registro</h3>
              <p>Crie sua conta e ganhe 100 XP para começar sua jornada!</p>
              <div class="achievement-progress">
                <div class="achievement-bar" data-progress="100" style="width: 100%"></div>
              </div>
            </div>
          </div>

          <div class="col-lg-6 mb-5 mb-lg-0">
            <div class="bloco card">
              <div class="card-body py-4 px-md-5">
                <!-- Tabs Nav -->
                <ul class="nav nav-tabs mb-4" id="authTabs" role="tablist">
                  <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="login-tab" data-bs-toggle="tab" data-bs-target="#login-pane" type="button" role="tab" aria-controls="login-pane" aria-selected="true">
                      <i class="fas fa-sign-in-alt me-2"></i> Login
                    </button>
                  </li>
                  <li class="nav-item" role="presentation">
                    <button class="nav-link" id="signup-tab" data-bs-toggle="tab" data-bs-target="#signup-pane" type="button" role="tab" aria-controls="signup-pane" aria-selected="false">
                      <i class="fas fa-user-plus me-2"></i> Cadastro
                    </button>
                  </li>
                </ul>
                
                <!-- Registration Notice -->
                <div class="alert alert-info mb-4" role="alert">
                  <i class="fas fa-info-circle me-2"></i> É necessário se cadastrar antes de fazer login. Se você ainda não tem uma conta, clique na aba <strong>Cadastro</strong>.
                </div>
                
                <!-- Tab Content -->
                <div class="tab-content" id="authTabsContent">
                  <!-- Login Tab -->
                  <div class="tab-pane fade show active" id="login-pane" role="tabpanel" aria-labelledby="login-tab">
                    <form id="loginForm">
                      <!-- Email input -->
                      <div class="form-outline mb-4">
                        <label for="loginUsername" class="form-label">Nome de Usuário ou Email</label>
                        <input type="text" class="form-control" id="loginUsername" placeholder="Digite seu usuário ou email">
                        <div class="invalid-feedback">
                          Por favor, informe seu nome de usuário ou email.
                        </div>
                      </div>

                      <!-- Password input -->
                      <div class="mb-4">
                        <label for="loginPassword" class="form-label">Senha</label>
                        <div class="input-group">
                          <input type="password" class="form-control" id="loginPassword" placeholder="Digite sua senha">
                          <span class="input-group-text"><i class="far fa-eye-slash" id="toggleLoginPassword"></i></span>
                        </div>
                        <div class="invalid-feedback">
                          Por favor, informe sua senha.
                        </div>
                      </div>
                      
                      <!-- Remember me & Forgot password -->
                      <div class="d-flex justify-content-between mb-4">
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="rememberMe">
                          <label class="form-check-label" for="rememberMe">Lembrar-me</label>
                        </div>
                        <a href="#" class="login text-decoration-none">Esqueceu a senha?</a>
                      </div>

                      <!-- Submit button -->
                      <button type="button" id="loginBtn" class="registrar btn btn-block mb-4 w-100" data-validation="loginCredentials">
                        <i class="fas fa-sign-in-alt me-2"></i> Login
                      </button>
                      
                      <!-- Login error message -->
                      <div class="alert alert-danger d-none" id="loginErrorMessage">
                        Nome de usuário ou senha incorretos. Por favor, tente novamente.
                      </div>

                      <!-- Social login buttons -->
                      <div class="text-center">
                        <p class="txtOpcoes">Ou entre com:</p>
                        <div class="social-login">
                          <button type="button" class="btn btn-link btn-floating mx-1">
                            <i class="fab fa-facebook-f icon-social"></i>
                          </button>
                          <button type="button" class="btn btn-link btn-floating mx-1">
                            <i class="fab fa-google icon-social"></i>
                          </button>
                          <button type="button" class="btn btn-link btn-floating mx-1">
                            <i class="fab fa-twitter icon-social"></i>
                          </button>
                        </div>
                      </div>
                    </form>
                  </div>
                  
                  <!-- Sign Up Tab -->
                  <div class="tab-pane fade" id="signup-pane" role="tabpanel" aria-labelledby="signup-tab">
                    <form id="signupForm">
                      <!-- Name inputs -->
                      <div class="row mb-4">
                        <div class="col-md-6">
                          <label for="firstName" class="form-label">Nome</label>
                          <input type="text" class="form-control" id="firstName">
                          <div class="invalid-feedback">
                            Por favor, informe seu nome.
                          </div>
                        </div>
                        <div class="col-md-6">
                          <label for="lastName" class="form-label">Sobrenome</label>
                          <input type="text" class="form-control" id="lastName">
                          <div class="invalid-feedback">
                            Por favor, informe seu sobrenome.
                          </div>
                        </div>
                      </div>

                      <!-- Email input -->
                      <div class="form-outline mb-4">
                        <label for="signupEmail" class="form-label">Email</label>
                        <input type="email" class="form-control" id="signupEmail" placeholder="example@email.com">
                        <div class="invalid-feedback">
                          Por favor, informe um email válido.
                        </div>
                      </div>

                      <!-- Password input -->
                      <div class="mb-4">
                        <label for="signupPassword" class="form-label">Senha</label>
                        <div class="input-group">
                          <input type="password" class="form-control" id="signupPassword" placeholder="Digite uma senha" maxlength="16">
                          <span class="input-group-text"><i class="far fa-eye-slash" id="toggleSignupPassword"></i></span>
                        </div>
                        <div class="invalid-feedback">
                          A senha deve ter pelo menos 6 caracteres.
                        </div>
                        <!-- Password requirements list -->
                        <div class="password-requirements mt-2">
                          <p class="mb-1 small">Sua senha deve conter:</p>
                          <ul class="small ps-3 mb-0">
                            <li id="length-check">Mínimo de 8 caracteres</li>
                            <li id="uppercase-check">Pelo menos uma letra maiúscula</li>
                            <li id="lowercase-check">Pelo menos uma letra minúscula</li>
                            <li id="number-check">Pelo menos um número</li>
                            <li id="special-check">Pelo menos um caractere especial (@, $, !, %, *, ?, &, #)</li>
                          </ul>
                        </div>
                      </div>
                      
                      <!-- Confirm Password input -->
                      <div class="mb-4">
                        <label for="confirmPassword" class="form-label">Confirme sua senha</label>
                        <div class="input-group">
                          <input type="password" class="form-control" id="confirmPassword" placeholder="Confirmar Senha" maxlength="16">
                          <span class="input-group-text"><i class="far fa-eye-slash" id="toggleConfirmPassword"></i></span>
                        </div>
                        <div class="invalid-feedback">
                          As senhas não coincidem ou não atendem aos requisitos.
                        </div>
                        <!-- Confirm Password requirements list -->
                        <div class="password-requirements mt-2">
                          <p class="mb-1 small">As senhas devem:</p>
                          <ul class="small ps-3 mb-0">
                            <li id="match-check">Ser idênticas</li>
                          </ul>
                        </div>
                      </div>

                      <!-- Checkbox -->
                      <div class="form-check d-flex mb-4">
                        <input class="form-check-input me-2" type="checkbox" id="agreeTerms" checked />
                        <label class="form-check-label" for="agreeTerms">
                          Quero receber notificações sobre promoções e novidades
                        </label>
                      </div>

                      <!-- Submit button -->
                      <button type="button" id="signupBtn" class="registrar btn btn-block mb-4 w-100" data-validation="registrationForm">
                        <i class="fas fa-user-plus me-2"></i> Cadastrar
                      </button>

                      <!-- Social signup buttons -->
                      <div class="text-center">
                        <p class="txtOpcoes">Ou cadastre-se com:</p>
                        <div class="social-login">
                          <button type="button" class="btn btn-link btn-floating mx-1">
                            <i class="fab fa-facebook-f icon-social"></i>
                          </button>
                          <button type="button" class="btn btn-link btn-floating mx-1">
                            <i class="fab fa-google icon-social"></i>
                          </button>
                          <button type="button" class="btn btn-link btn-floating mx-1">
                            <i class="fab fa-twitter icon-social"></i>
                          </button>
                        </div>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Immersive Footer -->
    <footer class="footer-immersive">
      <div class="container">
        <div class="row">
          <div class="col-md-3 mb-4">
            <img src="../assets/images/logo.png" alt="BuscaGames" class="footer-logo mb-3">
            <p class="footer-description">
              Sua plataforma gamificada para encontrar as melhores ofertas de jogos e acumular recompensas!
            </p>
            <div class="footer-social mt-3">
              <a href="#" class="social-icon"><i class="fab fa-facebook-f"></i></a>
              <a href="#" class="social-icon"><i class="fab fa-twitter"></i></a>
              <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a>
              <a href="#" class="social-icon"><i class="fab fa-discord"></i></a>
            </div>
          </div>
          
          <div class="col-md-3 mb-4">
            <h4 class="footer-title">Navegação</h4>
            <ul class="footer-links">
              <li><a href="../index.html" class="footer-link"><i class="fas fa-angle-right me-2"></i> Home</a></li>
              <li><a href="games.html" class="footer-link"><i class="fas fa-angle-right me-2"></i> Games</a></li>
              <li><a href="quests.html" class="footer-link"><i class="fas fa-angle-right me-2"></i> Quests</a></li>
              <li><a href="info.html" class="footer-link"><i class="fas fa-angle-right me-2"></i> Informações</a></li>
              <li><a href="profile.html" class="footer-link"><i class="fas fa-angle-right me-2"></i> Perfil</a></li>
            </ul>
          </div>
          
          <div class="col-md-3 mb-4">
            <h4 class="footer-title">Categorias</h4>
            <ul class="footer-links">
              <li><a href="games.html?category=rpg" class="footer-link"><i class="fas fa-angle-right me-2"></i> RPG</a></li>
              <li><a href="games.html?category=action" class="footer-link"><i class="fas fa-angle-right me-2"></i> Ação</a></li>
              <li><a href="games.html?category=adventure" class="footer-link"><i class="fas fa-angle-right me-2"></i> Aventura</a></li>
              <li><a href="games.html?category=strategy" class="footer-link"><i class="fas fa-angle-right me-2"></i> Estratégia</a></li>
              <li><a href="games.html?category=all" class="footer-link"><i class="fas fa-angle-right me-2"></i> Ver Todas</a></li>
            </ul>
          </div>
          
          <div class="col-md-3 mb-4">
            <h4 class="footer-title">Contato</h4>
            <ul class="footer-contact">
              <li><i class="fas fa-envelope me-2"></i> contato@buscagames.com</li>
              <li><i class="fas fa-phone me-2"></i> (11) 99123-4567</li>
              <li><i class="fas fa-map-marker-alt me-2"></i> São Paulo, SP - Brasil</li>
            </ul>
            <div class="footer-store-badges mt-3">
              <img src="../assets/images/app-store-badge.png" alt="App Store" class="store-badge">
              <img src="../assets/images/play-store-badge.png" alt="Play Store" class="store-badge">
            </div>
          </div>
        </div>
        
        <div class="footer-bottom mt-4 pt-4 border-top border-secondary">
          <div class="row">
            <div class="col-md-6">
              <p class="mb-0">&copy; 2025 BuscaGames. Todos os direitos reservados.</p>
            </div>
            <div class="col-md-6 text-md-end">
              <a href="#" class="footer-bottom-link me-3">Política de Privacidade</a>
              <a href="#" class="footer-bottom-link me-3">Termos de Uso</a>
              <a href="#" class="footer-bottom-link">Ajuda</a>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <!-- Back to Top Button -->
    <a href="#" class="back-to-top" id="backToTop">
      <i class="fas fa-arrow-up"></i>
    </a>

    <!-- Scripts -->
    <script src="../assets/js/login.js"></script>
    <script src="../assets/js/script.js"></script>
    <script src="../assets/js/immersive.js"></script>
    <script>
      // Password visibility toggle functions
      document.addEventListener('DOMContentLoaded', function() {
        const toggleLoginPassword = document.getElementById('toggleLoginPassword');
        const loginPassword = document.getElementById('loginPassword');
        
        const toggleSignupPassword = document.getElementById('toggleSignupPassword');
        const signupPassword = document.getElementById('signupPassword');
        
        const toggleConfirmPassword = document.getElementById('toggleConfirmPassword');
        const confirmPassword = document.getElementById('confirmPassword');
        
        // Function to toggle password visibility
        function togglePasswordVisibility(passwordField, toggleIcon) {
          if (passwordField.getAttribute('type') === 'password') {
            passwordField.setAttribute('type', 'text');
            toggleIcon.classList.replace('fa-eye-slash', 'fa-eye');
          } else {
            passwordField.setAttribute('type', 'password');
            toggleIcon.classList.replace('fa-eye', 'fa-eye-slash');
          }
        }
        
        // Password validation elements
        const lengthCheck = document.getElementById('length-check');
        const uppercaseCheck = document.getElementById('uppercase-check');
        const lowercaseCheck = document.getElementById('lowercase-check');
        const numberCheck = document.getElementById('number-check');
        const specialCheck = document.getElementById('special-check');
        
        // Password validation function
        function validatePassword(password) {
          const minLength = 8;
          const hasUppercase = /[A-Z]/.test(password);
          const hasLowercase = /[a-z]/.test(password);
          const hasNumber = /[0-9]/.test(password);
          const hasSpecial = /[@$!%*?&#]/.test(password);
          
          // Update validation UI
          toggleValidClass(lengthCheck, password.length >= minLength);
          toggleValidClass(uppercaseCheck, hasUppercase);
          toggleValidClass(lowercaseCheck, hasLowercase);
          toggleValidClass(numberCheck, hasNumber);
          toggleValidClass(specialCheck, hasSpecial);
          
          // Log validation details for debugging
          console.log("Password validation:", {
            length: password.length >= minLength,
            uppercase: hasUppercase,
            lowercase: hasLowercase,
            number: hasNumber,
            special: hasSpecial
          });
          
          // Return overall validation status
          return password.length >= minLength && hasUppercase && hasLowercase && hasNumber && hasSpecial;
        }
        
        // Helper function to toggle valid class
        function toggleValidClass(element, isValid) {
          if (isValid) {
            element.classList.add('valid');
          } else {
            element.classList.remove('valid');
          }
        }
        
        // Add event listeners for password toggles
        if (toggleLoginPassword && loginPassword) {
          toggleLoginPassword.addEventListener('click', function() {
            togglePasswordVisibility(loginPassword, toggleLoginPassword);
          });
        }
        
        if (toggleSignupPassword && signupPassword) {
          toggleSignupPassword.addEventListener('click', function() {
            togglePasswordVisibility(signupPassword, toggleSignupPassword);
          });
          
          // Add real-time password validation
          signupPassword.addEventListener('input', function() {
            validatePassword(this.value);
          });
        }
        
        if (toggleConfirmPassword && confirmPassword) {
          toggleConfirmPassword.addEventListener('click', function() {
            togglePasswordVisibility(confirmPassword, toggleConfirmPassword);
          });
          
          // Validate confirm password matches and meets all requirements
          const matchCheck = document.getElementById('match-check');
          
          confirmPassword.addEventListener('input', function() {
            // Check if passwords match
            const isMatch = this.value === signupPassword.value;
            
            // Check if confirm password meets all requirements
            const confirmMinLength = 8;
            const confirmHasUppercase = /[A-Z]/.test(this.value);
            const confirmHasLowercase = /[a-z]/.test(this.value);
            const confirmHasNumber = /[0-9]/.test(this.value);
            const confirmHasSpecial = /[@$!%*?&#]/.test(this.value);
            
            const confirmMeetsRequirements = (
              this.value.length >= confirmMinLength &&
              confirmHasUppercase &&
              confirmHasLowercase &&
              confirmHasNumber &&
              confirmHasSpecial
            );
            
            // Update matching indicator
            if (matchCheck) {
              if (isMatch && this.value.length > 0) {
                matchCheck.classList.add('valid');
              } else {
                matchCheck.classList.remove('valid');
              }
            }
            
            // Update validity visual state
            const isValid = isMatch && confirmMeetsRequirements && this.value.length > 0;
            this.classList.toggle('is-valid', isValid);
            this.classList.toggle('is-invalid', !isValid && this.value.length > 0);
            
            console.log("Confirm password validation:", {
              password: signupPassword.value,
              confirmPassword: this.value,
              isMatch: isMatch,
              meetsRequirements: confirmMeetsRequirements,
              isValid: isValid
            });
          });
        }
        
        // Also validate password when signup form is submitted
        const signupBtn = document.getElementById('signupBtn');
        if (signupBtn) {
          signupBtn.addEventListener('click', function(event) {
            // Force password validation
            const password = signupPassword.value;
            const confirmPwd = confirmPassword.value;
            
            // Explicitly check each requirement for main password
            const minLength = 8;
            const hasUppercase = /[A-Z]/.test(password);
            const hasLowercase = /[a-z]/.test(password);
            const hasNumber = /[0-9]/.test(password);
            const hasSpecial = /[@$!%*?&#]/.test(password);
            
            // Check if all requirements are met
            const isPasswordValid = (
              password.length >= minLength && 
              hasUppercase && 
              hasLowercase && 
              hasNumber && 
              hasSpecial
            );
            
            // Check if confirm password is valid and matches
            const isConfirmValid = (
              confirmPwd.length >= minLength && 
              /[A-Z]/.test(confirmPwd) && 
              /[a-z]/.test(confirmPwd) && 
              /[0-9]/.test(confirmPwd) && 
              /[@$!%*?&#]/.test(confirmPwd)
            );
            
            const passwordsMatch = password === confirmPwd;
            
            console.log("Signup validation check:", {
              password,
              confirmPwd,
              passwordsMatch,
              passwordValid: isPasswordValid,
              confirmValid: isConfirmValid
            });
            
            // Check both passwords - if either fails or they don't match, show error
            if (!isPasswordValid || !isConfirmValid || !passwordsMatch) {
              // Prevent form submission
              event.preventDefault();
              event.stopPropagation();
              
              // Add invalid class to password fields
              if (!isPasswordValid) {
                signupPassword.classList.add('is-invalid');
              }
              
              if (!isConfirmValid || !passwordsMatch) {
                confirmPassword.classList.add('is-invalid');
              }
              
              // Create detailed error message
              let errorMessage = '';
              
              if (!isPasswordValid) {
                errorMessage = 'A senha deve conter:';
                if (password.length < minLength) errorMessage += '<br>- No mínimo 8 caracteres';
                if (!hasUppercase) errorMessage += '<br>- Pelo menos uma letra maiúscula';
                if (!hasLowercase) errorMessage += '<br>- Pelo menos uma letra minúscula';
                if (!hasNumber) errorMessage += '<br>- Pelo menos um número';
                if (!hasSpecial) errorMessage += '<br>- Pelo menos um caractere especial (@, $, !, %, *, ?, &, #)';
              } else if (!isConfirmValid) {
                errorMessage = 'A confirmação de senha não atende a todos os requisitos.';
              } else if (!passwordsMatch) {
                errorMessage = 'As senhas não coincidem.';
              }
              
              // Show alert message
              Swal.fire({
                icon: 'error',
                title: 'Validação de Senha',
                html: errorMessage || 'Por favor, insira uma senha válida e certifique-se de que os dois campos coincidem.',
                confirmButtonColor: '#8A65DF'
              });
              
              return false;
            } else {
              // Both passwords valid and matching
              signupPassword.classList.remove('is-invalid');
              signupPassword.classList.add('is-valid');
              confirmPassword.classList.remove('is-invalid');
              confirmPassword.classList.add('is-valid');
              
              // For demo/testing purposes only - override any existing form submission handler
              // In a real application, this should be integrated with the form's submit logic
              const formData = {
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                email: document.getElementById('signupEmail').value,
                password: password
              };
              
              // Store user in localStorage for later login verification
              const users = JSON.parse(localStorage.getItem('users')) || [];
              users.push(formData);
              localStorage.setItem('users', JSON.stringify(users));
              
              // Show success message
              Swal.fire({
                icon: 'success',
                title: 'Cadastro Realizado!',
                text: 'Sua conta foi criada com sucesso. Você já pode fazer login.',
                confirmButtonColor: '#8A65DF'
              }).then(() => {
                // Switch to login tab
                document.getElementById('login-tab').click();
              });
              
              return false;
            }
          });
        }
        
        // Login verification
        const loginBtn = document.getElementById('loginBtn');
        const loginUsername = document.getElementById('loginUsername');
        const loginErrorMessage = document.getElementById('loginErrorMessage');
        
        if (loginBtn) {
          loginBtn.addEventListener('click', function(event) {
            // Hide any previous error messages
            if (loginErrorMessage) {
              loginErrorMessage.classList.add('d-none');
            }
            
            // Basic validation
            if (!loginUsername.value || !loginPassword.value) {
              return; // Let the existing validation handle empty fields
            }
            
            // Check if the user exists in localStorage
            const users = JSON.parse(localStorage.getItem('users')) || [];
            const user = users.find(u => 
              u.email === loginUsername.value || 
              (u.firstName && u.firstName.toLowerCase() === loginUsername.value.toLowerCase())
            );
            
            if (!user) {
              // User not found
              if (loginErrorMessage) {
                loginErrorMessage.textContent = 'Usuário não encontrado. Por favor, verifique as credenciais.';
                loginErrorMessage.classList.remove('d-none');
              }
              
              // Show SweetAlert error
              Swal.fire({
                icon: 'error',
                title: 'Usuário não encontrado',
                text: 'Por favor, verifique suas credenciais ou crie uma nova conta.',
                confirmButtonColor: '#8A65DF'
              });
              
              event.preventDefault();
              return false;
            }
            
            // Check if the password matches
            if (user.password !== loginPassword.value) {
              // Password doesn't match
              if (loginErrorMessage) {
                loginErrorMessage.textContent = 'Senha incorreta. Por favor, tente novamente.';
                loginErrorMessage.classList.remove('d-none');
              }
              
              // Show SweetAlert error
              Swal.fire({
                icon: 'error',
                title: 'Senha Incorreta',
                text: 'A senha fornecida não corresponde ao usuário. Por favor, tente novamente.',
                confirmButtonColor: '#8A65DF'
              });
              
              event.preventDefault();
              return false;
            }
            
            // If we get here, login is successful
            // Store login information and redirect
            localStorage.setItem('isLoggedIn', 'true');
            localStorage.setItem('currentUser', JSON.stringify(user));
            
            // Show success message
            Swal.fire({
              icon: 'success',
              title: 'Login Bem-sucedido!',
              text: `Bem-vindo de volta, ${user.firstName}!`,
              confirmButtonColor: '#8A65DF'
            }).then(() => {
              // Redirect to home page after successful login
              window.location.href = '../index.html';
            });
          });
        }
        
        // Initialize cart count
        updateCartCount();
      });
    </script>
    <script src="../assets/js/theme.js"></script>
    <script src="../assets/js/userDropdown.js"></script>

  </body>
</html>